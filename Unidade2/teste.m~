% Parâmetros
EbN0_dB = [0, 5, 20];                                       % Eb/N0 de entrada

Ns = 10^5;                                                  % Número de símbolos simulados

%M = [2, 8];                                                 % Número de símbolo da modulação
M = 2;

% Sinal BPSK gerado pela função pskmod
bits2 = randi([0 M-1],Ns,1);
txSig = pskmod(bits2,M);

rxSig1 = awgn(txSig,EbN0_dB(1));
rxSig2 = awgn(txSig,EbN0_dB(2));
rxSig3 = awgn(txSig,EbN0_dB(3));

% Gráficos
fig=figure;
subplot(2,3,1);
plot(rxSig1(find(real(rxSig1)>0)),'ro');
hold on;
plot(rxSig1(find(real(rxSig1)<=0)),'bs')
title('Eb/N0 = 5 - BPSK');
legend('Bit 1 transmitido','Bit 0 transmitido');
minAx = min([real(rxSig1)' imag(rxSig1)']);
maxAx = max([real(rxSig1)' imag(rxSig1)']);
axis([minAx maxAx minAx maxAx]);

subplot(2,3,2);
plot(rxSig2(find(real(rxSig2)>0)),'ro');
hold on;
plot(rxSig2(find(real(rxSig2)<=0)),'bs')
title('Eb/N0 = 20 - BPSK');
legend('Bit 1 transmitido','Bit 0 transmitido');
minAx = min([real(rxSig2)' imag(rxSig2)']);
maxAx = max([real(rxSig2)' imag(rxSig2)']);
axis([minAx maxAx minAx maxAx]);

subplot(2,3,3);
plot(rxSig(find(real(rxSig)>0)),'ro');
hold on;
plot(rxSig(find(real(rxSig)<=0)),'bs')
title('Eb/N0 = 5 - 8-PSK');
legend('Bit 1 transmitido','Bit 0 transmitido');
minAx = min([real(rxSig)' imag(rxSig)']);
maxAx = max([real(rxSig)' imag(rxSig)']);
axis([minAx maxAx minAx maxAx]);

subplot(2,3,4);
plot(rxSig(find(real(rxSig)>0)),'ro');
hold on;
plot(rxSig(find(real(rxSig)<=0)),'bs')
title('Eb/N0 = 20 - 8-PSK');
legend('Bit 1 transmitido','Bit 0 transmitido');
minAx = min([real(rxSig)' imag(rxSig)']);
maxAx = max([real(rxSig)' imag(rxSig)']);
axis([minAx maxAx minAx maxAx]);

fig.PaperUnits = 'inches';
fig.PaperPosition = [0 0 10 10];